<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Save Assembly as Part (Exterior Components) Macro for SolidWorks | SOLIDWORKS Macros Lib </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Save Assembly as Part (Exterior Components) Macro for SolidWorks | SOLIDWORKS Macros Lib ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/BlueByteSystemsInc/SOLIDWORKSVBAMacros/blob/main/V2/LAST/src/Save Assy As Part (Exterior Components).md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../images/fav.png" alt="SOLIDWORKS VBA Macros Lib">
            SOLIDWORKS VBA Macros Lib
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="save-assembly-as-part-exterior-components-macro-for-solidworks">Save Assembly as Part (Exterior Components) Macro for SolidWorks</h1>

<img src="../images/SaveAssemblyasPartExteriorComponents.png" alt="Description of image" width="600" style="display: block; margin: 0 auto;">
<h2 id="description">Description</h2>
<p>This macro converts an active SolidWorks assembly into a part file that contains only the exterior components. This feature is useful for reducing the complexity of the assembly when sharing with external stakeholders or for performance improvements in visualization and analysis.</p>
<h2 id="system-requirements">System Requirements</h2>
<ul>
<li><strong>SolidWorks Version</strong>: SolidWorks 2014 or newer</li>
<li><strong>Operating System</strong>: Windows 7 or later</li>
</ul>
<h2 id="pre-conditions">Pre-Conditions</h2>
<div class="NOTE">
<h5>Note</h5>
<ul>
<li>An assembly document (.SLDASM) must be actively open in SolidWorks.</li>
<li>The assembly should include at least one part to be processed.</li>
</ul>
</div>
<h2 id="results">Results</h2>
<div class="NOTE">
<h5>Note</h5>
<ul>
<li>The macro saves the active assembly as a new part (.SLDPRT) file that includes only the exterior components.</li>
<li>The new part file is saved in the same directory as the original assembly with the same base file name followed by &quot;SLDPRT&quot;.</li>
</ul>
</div>
<h2 id="steps-to-setup-the-macro">Steps to Setup the Macro</h2>
<ol>
<li><p><strong>Prepare SolidWorks</strong>:</p>
<ul>
<li>Open SolidWorks with the target assembly document loaded.</li>
<li>Ensure that the assembly contains at least one part component.</li>
</ul>
</li>
<li><p><strong>Configure and Run the Macro</strong>:</p>
<ul>
<li>Open the SolidWorks VBA editor by pressing (<code>Alt + F11</code>).</li>
<li>Insert a new module and copy the provided macro code into this module.</li>
<li>Run the macro from within SolidWorks by navigating to <strong>Tools</strong> &gt; <strong>Macro</strong> &gt; <strong>Run</strong>, then select your saved macro file.</li>
</ul>
</li>
<li><p><strong>Using the Macro</strong>:</p>
<ul>
<li>The macro will automatically save the active document as a new part file with only the exterior components.</li>
<li>The original assembly remains unchanged.</li>
</ul>
</li>
</ol>
<h2 id="vba-macro-code">VBA Macro Code</h2>
<pre><code class="lang-vbnet">' Disclaimer:
' The code provided should be used at your own risk.  
' Blue Byte Systems Inc. assumes no responsibility for any issues or damages that may arise from using or modifying this code.  
' For more information, visit [Blue Byte Systems Inc.](https://bluebyte.biz).

Option Explicit

' SolidWorks application and document variables
Dim swApp As SldWorks.SldWorks                    ' SolidWorks application object
Dim swModel As SldWorks.ModelDoc2                 ' Active SolidWorks document object
Dim swModelDocExt As SldWorks.ModelDocExtension   ' Extension object for advanced file operations
Dim FilePath As String                            ' Full file path of the current document
Dim PathSize As Long                              ' Length of the file path
Dim PathNoExtension As String                     ' File path without extension
Dim NewFilePath As String                         ' File path for the new part file
Dim nErrors As Long                               ' Counter for errors during the save operation
Dim nWarnings As Long                             ' Counter for warnings during the save operation

' Main subroutine
Sub main()
    ' Initialize SolidWorks application and get the active document
    Set swApp = Application.SldWorks
    Set swModel = swApp.ActiveDoc

    ' Check if a document is open
    If swModel Is Nothing Then
        MsgBox &quot;No active document found. Please open a file.&quot;
        Exit Sub
    End If

    ' Get the ModelDocExtension object for advanced operations
    Set swModelDocExt = swModel.Extension

    ' Extract the file path and prepare the new file path
    FilePath = swModel.GetPathName                     ' Get the full file path of the active document
    PathSize = Strings.Len(FilePath)                  ' Get the length of the file path
    PathNoExtension = Strings.Left(FilePath, PathSize - 6) ' Remove the last 6 characters (e.g., &quot;.SLDASM&quot;)
    NewFilePath = PathNoExtension &amp; &quot;SLDPRT&quot;          ' Append &quot;SLDPRT&quot; to create the new file path

    ' Set options to save only the exterior components
    swApp.SetUserPreferenceIntegerValue swSaveAssemblyAsPartOptions, swSaveAsmAsPart_ExteriorComponents

    ' Save the assembly as a new part file
    swModelDocExt.SaveAs NewFilePath, swSaveAsCurrentVersion, swSaveAsOptions_Silent, Nothing, nErrors, nWarnings

    ' Check for errors and warnings during the save operation
    If nErrors = 0 And nWarnings = 0 Then
        ' Success: Notify the user that the save operation was successful
        MsgBox &quot;Assembly saved as part file successfully at: &quot; &amp; NewFilePath
    Else
        ' Failure: Notify the user about errors and warnings
        MsgBox &quot;Failed to save assembly as part file. Errors: &quot; &amp; nErrors &amp; &quot;, Warnings: &quot; &amp; nWarnings
    End If
End Sub
</code></pre>
<h2 id="macro">Macro</h2>
<p>You can download the macro from <a href="../files/SaveAssemblyasPartExteriorComponents.swp">here</a></p>
<h2 id="customization">Customization</h2>
<p>Need to modify the macro to meet specific requirements or integrate it with other processes? We provide custom macro development tailored to your needs. <a href="https://bluebyte.biz/contact">Contact us</a>.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/BlueByteSystemsInc/SOLIDWORKSVBAMacros/blob/main/V2/LAST/src/Save Assy As Part (Exterior Components).md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Hosted and provided by <a href='https://bluebyte.biz'>Blue Byte Systems Inc</a>. Made with Maple syrup 🍁 and Couscous 🍲.</span>
        </div>
      </div>
    </footer>
  </body>
</html>
