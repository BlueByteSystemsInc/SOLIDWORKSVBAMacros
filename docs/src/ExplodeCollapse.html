<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Explode/Collapse Toggle Macro for SolidWorks Assemblies | &#129513; SOLIDWORKS VBA Macros Library </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Explode/Collapse Toggle Macro for SolidWorks Assemblies | &#129513; SOLIDWORKS VBA Macros Library ">
      
      
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/BlueByteSystemsInc/SOLIDWORKSVBAMacros/blob/main/src/ExplodeCollapse.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/fav.png" alt="&#129513; SOLIDWORKS VBA Macros Library">
            &#129513; SOLIDWORKS VBA Macros Library
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="explodecollapse-toggle-macro-for-solidworks-assemblies">Explode/Collapse Toggle Macro for SolidWorks Assemblies</h1>

<h2 id="description">Description</h2>
<p>This macro toggles the explode or collapse state of the first exploded view found in the active configuration of an assembly document in SolidWorks. It is useful for quickly changing the view state of an assembly to better visualize the layout and positioning of components.</p>
<h2 id="system-requirements">System Requirements</h2>
<ul>
<li><strong>SolidWorks Version</strong>: SolidWorks 2014 or newer</li>
<li><strong>Operating System</strong>: Windows 7 or later</li>
</ul>
<h2 id="pre-conditions">Pre-Conditions</h2>
<div class="NOTE">
<h5>Note</h5>
<ul>
<li>An assembly document must be open in SolidWorks.</li>
<li>The assembly should have at least one exploded view in its active configuration.</li>
</ul>
</div>
<h2 id="results">Results</h2>
<div class="NOTE">
<h5>Note</h5>
<ul>
<li>Toggles the first exploded view of the assembly to either an exploded or collapsed state, depending on its current state.</li>
</ul>
</div>
<h2 id="steps-to-setup-the-macro">Steps to Setup the Macro</h2>
<ol>
<li><p><strong>Create the VBA Module</strong>:</p>
<ul>
<li>Open the SolidWorks VBA editor by pressing (<code>Alt + F11</code>).</li>
<li>Insert a new module into your project and copy the provided macro code into this module.</li>
</ul>
</li>
<li><p><strong>Run the Macro</strong>:</p>
<ul>
<li>Ensure that an assembly with at least one exploded view is open.</li>
<li>Execute the macro from within SolidWorks by navigating to <strong>Tools</strong> &gt; <strong>Macro</strong> &gt; <strong>Run</strong>, then select your macro file.</li>
</ul>
</li>
<li><p><strong>Using the Macro</strong>:</p>
<ul>
<li>The macro automatically checks the first exploded view in the active configuration and toggles its state.</li>
<li>No user interaction is required beyond starting the macro.</li>
</ul>
</li>
</ol>
<h2 id="vba-macro-code">VBA Macro Code</h2>
<pre><code class="lang-vbnet">' Disclaimer:
' The code provided should be used at your own risk.  
' Blue Byte Systems Inc. assumes no responsibility for any issues or damages that may arise from using or modifying this code.  
' For more information, visit [Blue Byte Systems Inc.](https://bluebyte.biz).

' *******************************************************************************
' This macro toggles the explode/collapse state of the first exploded view
' in the active configuration of an assembly document.
' *******************************************************************************

' Declare variables for SolidWorks objects and operations
Dim swApp As SldWorks.SldWorks                   ' SolidWorks application object
Dim swModel As SldWorks.ModelDoc2                ' Active document object
Dim swModelDocExt As SldWorks.ModelDocExtension  ' ModelDocExtension object
Dim swAssembly As SldWorks.AssemblyDoc           ' Assembly document object
Dim swConfigMgr As SldWorks.ConfigurationManager ' Configuration manager object
Dim swConfig As SldWorks.Configuration           ' Active configuration object
Dim activeConfigName As String                   ' Name of the active configuration
Dim viewNames As Variant                         ' Array of exploded view names
Dim viewName As String                           ' Individual exploded view name
Dim i As Long                                    ' Loop counter
Dim xViewCount As Long                           ' Number of exploded views in the configuration
Dim boolstatus As Boolean                        ' Boolean for operation success

' Main subroutine
Sub main()

    ' Initialize SolidWorks application and active document
    Set swApp = Application.SldWorks
    Set swModel = swApp.ActiveDoc

    ' Check if the active document is an assembly
    If (swModel.GetType &lt;&gt; swDocASSEMBLY) Then Exit Sub

    ' Cast the active document as an assembly
    Set swAssembly = swModel

    ' Get the active configuration name
    Set swConfigMgr = swModel.ConfigurationManager
    Set swConfig = swConfigMgr.ActiveConfiguration
    activeConfigName = swConfig.Name

    ' Get the number of exploded views in the active configuration
    xViewCount = swAssembly.GetExplodedViewCount2(activeConfigName)
    If xViewCount &lt; 1 Then End ' Exit if no exploded views exist

    ' Retrieve the names of the exploded views in the active configuration
    viewNames = swAssembly.GetExplodedViewNames2(activeConfigName)

    ' Select the first exploded view in the list
    boolstatus = swAssembly.Extension.SelectByID2(viewNames(0), &quot;EXPLODEDVIEWS&quot;, 0, 0, 0, False, 0, Nothing, 0)
    If boolstatus = False Then End ' Exit if the selection fails

    ' Check if the assembly is currently exploded or collapsed
    boolstatus = swAssembly.IsExploded

    ' Toggle the explode/collapse state based on the current state
    If boolstatus = False Then
        swAssembly.ViewExplodeAssembly ' Explode the assembly
    Else
        swAssembly.ViewCollapseAssembly ' Collapse the assembly
    End If

    ' Clear the selection to finish the operation
    swAssembly.ClearSelection2 True

    ' Clean up references and end the macro
    Set swModel = Nothing
    Set swAssembly = Nothing

End Sub
</code></pre>
<h2 id="customization">Customization</h2>
<p>Need to modify the macro to meet specific requirements or integrate it with other processes? We provide custom macro development tailored to your needs. <a href="https://bluebyte.biz/contact">Contact us</a>.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/BlueByteSystemsInc/SOLIDWORKSVBAMacros/blob/main/src/ExplodeCollapse.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Hosted and provided by <a href='https://bluebyte.biz'>Blue Byte Systems Inc</a>. Made with Maple syrup 🍁 and Couscous 🍲.</span>
        </div>
      </div>
    </footer>
  </body>
</html>
